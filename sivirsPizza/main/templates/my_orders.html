{% extends 'base.html' %}

{% block content %}
<h1>My Orders</h1>

{% for delivery in deliveries %}
    <div class="order-card">
        <h2>Order #{{ delivery.id }}</h2>

        {% with pizzas=delivery.pizza_set.all %}
            {% if pizzas %}
                {% for pizza in pizzas %}
                    <p><b>Pizza Type:</b> {{ pizza.size }} - {{ pizza.crust }}</p>
                    <p><b>Toppings:</b> 
                        {% for topping in pizza.toppings.all %}
                            {{ topping.topping }}{% if not forloop.last %}, {% endif %}
                        {% empty %}
                            None
                        {% endfor %}
                    </p>
                {% endfor %}
            {% else %}
                <p>No pizzas in this order.</p>
            {% endif %}
        {% endwith %}
        
        <p><b>Delivery Address:</b> {{ delivery.address }}</p>
        <p><b>Order Date:</b> {{ delivery.date }}</p>
    </div>
{% empty %}
    <p>No orders found.</p>
{% endfor %}

{% endblock %}
